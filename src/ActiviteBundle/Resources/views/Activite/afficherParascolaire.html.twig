{% extends 'back/admin.html.twig' %}
{% block body %}
<h1 class="text-center">LISTER TOUS LES PARASCOLAIRES</h1>
<h4>Search</h4>

<div class="sidebar-search">
    <div class="input-group custom-search-form">
        <input type="text" id="search" class="form-check-inline" placeholder="Search here" >
    </div>
</div>
<ul class="nav" id="side-menu">
    <ul>
        <ul class="nav nav-second-level" id="entitiesNav">
        </ul>
    </ul>
</ul>
    <h2 class="text-xl-right"><a href="{{ path('ajouterParascolaire') }}" >Add</a></h2>
    <table class="table table-head-fixed">
    <th class="text-right">{{ count }} : Enfants dans la visite culturel</th>
    <th class="text-right">{{ excursion }} : Enfants dans l'exursion</th>
    <th class="text-xl-right">{{ sortie }} : Enfants dans la sortie</th>
    </table>
<table class="table table-hover">
    <tr>

        <th>type</th>
        <th>lieu</th>
        <th>date debut</th>
        <th>date fin</th>
        <th>identifiant Enfant</th>
        <th>supprimer</th>
        <th>Modifier</th>

    </tr>
    {% for p in parascolaire %}
        <tr>
            <td>{{ p.typeParascolaire}}</td>
            <td>{{ p.lieuParascolaire }}</td>
            <td>{{ p.dateDebutParascolaire | date('d/m/y,h:s') }}</td>
            <td>{{ p.dateFinParascolaire | date('d/m/y,h:s') }}</td>
            <td>{{ p.enfant.id }}</td>
            <td><a href="{{  path('supprimerParascolaire',{'id': p.idParascolaire}) }}"> supprimer </a></td>
            <td><a href="{{  path('modifierParascolaire',{'id': p.idParascolaire}) }}">modifier</a></td>
        </tr>
    {% endfor %}
</table>
<script type="text/javascript" src="{{ asset("jquery-3.4.1.min.js") }}"></script>
<script type="text/javascript">
    $(function() {
        var searchRequest = null;
        $("#search").keyup(function() {
            var minlength = 1;
            var that = this;
            var value = $(this).val();
            var entitySelector = $("#entitiesNav").html('');
            if (value.length >= minlength ) {
                if (searchRequest != null)
                    searchRequest.abort();
                searchRequest = $.ajax({
                    type: "GET",
                    url: "{{ path('searchParascolaire') }}",
                    data: {
                        'q' : value
                    },
                    dataType: "text",
                    success: function(msg){
                        //we need to check if the value is the same
                        if (value===$(that).val()) {
                            var result = JSON.parse(msg);
                            if (result['para']){
                            }else {
                                $.each(result, function(key, value) {
                                    console.log(value);
                                    entitySelector.append('<li><b>'+value +'</li><b>');
                                })
                            }
                        }
                    }
                });
            }
        });
    });
</script>

{% endblock %}